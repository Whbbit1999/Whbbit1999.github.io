import{_ as s,o as n,c as a,a as p}from"./app.ed522904.js";const E=JSON.parse('{"title":"\u5FAE\u4FE1\u652F\u4ED8\uFF08uniapp\uFF09","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u4F9D\u8D56\u52A0\u5BC6\u5305","slug":"\u4F9D\u8D56\u52A0\u5BC6\u5305","link":"#\u4F9D\u8D56\u52A0\u5BC6\u5305","children":[]},{"level":2,"title":"\u5C0F\u7A0B\u5E8F\u652F\u4ED8\u65F6\u7684\u4E8C\u6B21\u7B7E\u540D","slug":"\u5C0F\u7A0B\u5E8F\u652F\u4ED8\u65F6\u7684\u4E8C\u6B21\u7B7E\u540D","link":"#\u5C0F\u7A0B\u5E8F\u652F\u4ED8\u65F6\u7684\u4E8C\u6B21\u7B7E\u540D","children":[]},{"level":2,"title":"app \u652F\u4ED8\u65F6\u7684\u4E8C\u6B21\u7B7E\u540D","slug":"app-\u652F\u4ED8\u65F6\u7684\u4E8C\u6B21\u7B7E\u540D","link":"#app-\u652F\u4ED8\u65F6\u7684\u4E8C\u6B21\u7B7E\u540D","children":[]}],"relativePath":"program/miniprogram/payment.md","lastUpdated":1663203734000}'),l={name:"program/miniprogram/payment.md"},o=p(`<h1 id="\u5FAE\u4FE1\u652F\u4ED8\uFF08uniapp\uFF09" tabindex="-1">\u5FAE\u4FE1\u652F\u4ED8\uFF08uniapp\uFF09 <a class="header-anchor" href="#\u5FAE\u4FE1\u652F\u4ED8\uFF08uniapp\uFF09" aria-hidden="true">#</a></h1><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre class="vp-code-dark"><code><span class="line"><span style="color:#758575DD;">// \u8FD9\u91CC\u7684\u6570\u636E\u662F\u540E\u7AEF\u8FD4\u56DE\u7684\u8BA2\u5355\u6570\u636E</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">wechatOrder</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">orderInfo</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">appid</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">wx1e**********689f</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">noncestr</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">2rxK********Gv3A</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">package</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">Sign=WXPay</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">partnerid</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">16****039</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">prepayid</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">wx13************c615acf50000</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">timestamp</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">1663061271</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">sign</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">3513ECA3B3AC1AD6F7D8BA748970D51D2236589734518F086AB99673AAE844FE</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">};</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// \u8FD9\u91CC\u7684\u6570\u636E\u662F\u540E\u7AEF\u8FD4\u56DE\u7684\u8BA2\u5355\u6570\u636E</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">wechatOrder</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">orderInfo</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">appid</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">wx1e**********689f</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">noncestr</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">2rxK********Gv3A</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">package</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">Sign=WXPay</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">partnerid</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">16****039</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">prepayid</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">wx13************c615acf50000</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">timestamp</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">1663061271</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">sign</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">3513ECA3B3AC1AD6F7D8BA748970D51D2236589734518F086AB99673AAE844FE</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">};</span></span>
<span class="line"></span></code></pre></div><h2 id="\u4F9D\u8D56\u52A0\u5BC6\u5305" tabindex="-1">\u4F9D\u8D56\u52A0\u5BC6\u5305 <a class="header-anchor" href="#\u4F9D\u8D56\u52A0\u5BC6\u5305" aria-hidden="true">#</a></h2><div class="language-shell"><button class="copy"></button><span class="lang">shell</span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CAEE;">npm i crypto-js</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">npm i crypto-js</span></span>
<span class="line"></span></code></pre></div><h2 id="\u5C0F\u7A0B\u5E8F\u652F\u4ED8\u65F6\u7684\u4E8C\u6B21\u7B7E\u540D" tabindex="-1">\u5C0F\u7A0B\u5E8F\u652F\u4ED8\u65F6\u7684\u4E8C\u6B21\u7B7E\u540D <a class="header-anchor" href="#\u5C0F\u7A0B\u5E8F\u652F\u4ED8\u65F6\u7684\u4E8C\u6B21\u7B7E\u540D" aria-hidden="true">#</a></h2><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre class="vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">crypto</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">crypto-js/crypto-js</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">timeStamp</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">Math</span><span style="color:#666666;">.</span><span style="color:#80A665;">floor</span><span style="color:#666666;">(</span><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">Date</span><span style="color:#666666;">().</span><span style="color:#80A665;">getTime</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">/</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1000</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">key</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">53E12F838************5A43C5DC3</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#758575DD;">// \u4E8C\u6B21\u7B7E\u540D</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">sign</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">\`</span><span style="color:#C98A7D;">appId=</span><span style="color:#666666;">\${</span><span style="color:#C98A7D;">appid</span><span style="color:#666666;">}</span><span style="color:#C98A7D;">&amp;nonceStr=</span><span style="color:#666666;">\${</span><span style="color:#C98A7D;">wechatOrder</span><span style="color:#666666;">.</span><span style="color:#C98A7D;">orderInfo</span><span style="color:#666666;">.</span><span style="color:#C98A7D;">nonce_str</span><span style="color:#666666;">}</span><span style="color:#C98A7D;">&amp;package=prepay_id=</span><span style="color:#666666;">\${</span><span style="color:#C98A7D;">wechatOrder</span><span style="color:#666666;">.</span><span style="color:#C98A7D;">orderInfo</span><span style="color:#666666;">.</span><span style="color:#C98A7D;">prepay_id</span><span style="color:#666666;">}</span><span style="color:#C98A7D;">&amp;signType=HMAC-SHA256&amp;timeStamp=</span><span style="color:#666666;">\${</span><span style="color:#C98A7D;">timeStamp</span><span style="color:#666666;">}</span><span style="color:#C98A7D;">&amp;key=</span><span style="color:#666666;">\${</span><span style="color:#C98A7D;">key</span><span style="color:#666666;">}</span><span style="color:#C98A7DAA;">\`</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BD976A;">wx</span><span style="color:#666666;">.</span><span style="color:#80A665;">requestPayment</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">timeStamp</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">timeStamp</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">// \u65F6\u95F4\u6233\uFF08\u5355\u4F4D\uFF1A\u79D2\uFF09</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">nonceStr</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">wechatOrder</span><span style="color:#666666;">.</span><span style="color:#BD976A;">orderInfo</span><span style="color:#666666;">.</span><span style="color:#BD976A;">nonce_str</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">// \u968F\u673A\u5B57\u7B26\u4E32</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">package</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">\`</span><span style="color:#C98A7D;">prepay_id=</span><span style="color:#666666;">\${</span><span style="color:#C98A7D;">wechatOrder</span><span style="color:#666666;">.</span><span style="color:#C98A7D;">orderInfo</span><span style="color:#666666;">.</span><span style="color:#C98A7D;">prepay_id</span><span style="color:#666666;">}</span><span style="color:#C98A7DAA;">\`</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">// \u56FA\u5B9A\u503C</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">signType</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">HMAC-SHA256</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">//\u56FA\u5B9A\u503C</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">paySign</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">crypto</span><span style="color:#666666;">.</span><span style="color:#BD976A;">enc</span><span style="color:#666666;">.</span><span style="color:#BD976A;">Hex</span><span style="color:#666666;">.</span><span style="color:#80A665;">stringify</span><span style="color:#666666;">(</span><span style="color:#BD976A;">crypto</span><span style="color:#666666;">.</span><span style="color:#80A665;">HmacSHA256</span><span style="color:#666666;">(</span><span style="color:#BD976A;">sign</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">key</span><span style="color:#666666;">)).</span><span style="color:#80A665;">toUpperCase</span><span style="color:#666666;">(),</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#80A665;">success</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">res</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#BD976A;">console</span><span style="color:#666666;">.</span><span style="color:#80A665;">log</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">success:</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">JSON</span><span style="color:#666666;">.</span><span style="color:#80A665;">stringify</span><span style="color:#666666;">(</span><span style="color:#BD976A;">res</span><span style="color:#666666;">));</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#BD976A;">console</span><span style="color:#666666;">.</span><span style="color:#80A665;">log</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">\u652F\u4ED8\u6210\u529F</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">showToast</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#B8A965;">title</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">\u652F\u4ED8\u6210\u529F</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#80A665;">fail</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">function</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">err</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#BD976A;">console</span><span style="color:#666666;">.</span><span style="color:#80A665;">log</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">fail:</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">JSON</span><span style="color:#666666;">.</span><span style="color:#80A665;">stringify</span><span style="color:#666666;">(</span><span style="color:#BD976A;">err</span><span style="color:#666666;">));</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#BD976A;">console</span><span style="color:#666666;">.</span><span style="color:#80A665;">log</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">\u652F\u4ED8\u5931\u8D25</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#80A665;">showErrorMsgModal</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">      </span><span style="color:#B8A965;">content</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">err</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">});</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">crypto</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">crypto-js/crypto-js</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">timeStamp</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">Math</span><span style="color:#999999;">.</span><span style="color:#59873A;">floor</span><span style="color:#999999;">(</span><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#59873A;">Date</span><span style="color:#999999;">().</span><span style="color:#59873A;">getTime</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">/</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1000</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">key</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">53E12F838************5A43C5DC3</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#A0ADA0;">// \u4E8C\u6B21\u7B7E\u540D</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">sign</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">\`</span><span style="color:#B56959;">appId=</span><span style="color:#999999;">\${</span><span style="color:#B56959;">appid</span><span style="color:#999999;">}</span><span style="color:#B56959;">&amp;nonceStr=</span><span style="color:#999999;">\${</span><span style="color:#B56959;">wechatOrder</span><span style="color:#999999;">.</span><span style="color:#B56959;">orderInfo</span><span style="color:#999999;">.</span><span style="color:#B56959;">nonce_str</span><span style="color:#999999;">}</span><span style="color:#B56959;">&amp;package=prepay_id=</span><span style="color:#999999;">\${</span><span style="color:#B56959;">wechatOrder</span><span style="color:#999999;">.</span><span style="color:#B56959;">orderInfo</span><span style="color:#999999;">.</span><span style="color:#B56959;">prepay_id</span><span style="color:#999999;">}</span><span style="color:#B56959;">&amp;signType=HMAC-SHA256&amp;timeStamp=</span><span style="color:#999999;">\${</span><span style="color:#B56959;">timeStamp</span><span style="color:#999999;">}</span><span style="color:#B56959;">&amp;key=</span><span style="color:#999999;">\${</span><span style="color:#B56959;">key</span><span style="color:#999999;">}</span><span style="color:#B56959AA;">\`</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B07D48;">wx</span><span style="color:#999999;">.</span><span style="color:#59873A;">requestPayment</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">timeStamp</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">timeStamp</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">// \u65F6\u95F4\u6233\uFF08\u5355\u4F4D\uFF1A\u79D2\uFF09</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">nonceStr</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">wechatOrder</span><span style="color:#999999;">.</span><span style="color:#B07D48;">orderInfo</span><span style="color:#999999;">.</span><span style="color:#B07D48;">nonce_str</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">// \u968F\u673A\u5B57\u7B26\u4E32</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">package</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">\`</span><span style="color:#B56959;">prepay_id=</span><span style="color:#999999;">\${</span><span style="color:#B56959;">wechatOrder</span><span style="color:#999999;">.</span><span style="color:#B56959;">orderInfo</span><span style="color:#999999;">.</span><span style="color:#B56959;">prepay_id</span><span style="color:#999999;">}</span><span style="color:#B56959AA;">\`</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">// \u56FA\u5B9A\u503C</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">signType</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">HMAC-SHA256</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">//\u56FA\u5B9A\u503C</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">paySign</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">crypto</span><span style="color:#999999;">.</span><span style="color:#B07D48;">enc</span><span style="color:#999999;">.</span><span style="color:#B07D48;">Hex</span><span style="color:#999999;">.</span><span style="color:#59873A;">stringify</span><span style="color:#999999;">(</span><span style="color:#B07D48;">crypto</span><span style="color:#999999;">.</span><span style="color:#59873A;">HmacSHA256</span><span style="color:#999999;">(</span><span style="color:#B07D48;">sign</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">key</span><span style="color:#999999;">)).</span><span style="color:#59873A;">toUpperCase</span><span style="color:#999999;">(),</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#59873A;">success</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">res</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B07D48;">console</span><span style="color:#999999;">.</span><span style="color:#59873A;">log</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">success:</span><span style="color:#B56959AA;">&#39;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">JSON</span><span style="color:#999999;">.</span><span style="color:#59873A;">stringify</span><span style="color:#999999;">(</span><span style="color:#B07D48;">res</span><span style="color:#999999;">));</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B07D48;">console</span><span style="color:#999999;">.</span><span style="color:#59873A;">log</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">\u652F\u4ED8\u6210\u529F</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">showToast</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#998418;">title</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">\u652F\u4ED8\u6210\u529F</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#59873A;">fail</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">function</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">err</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B07D48;">console</span><span style="color:#999999;">.</span><span style="color:#59873A;">log</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">fail:</span><span style="color:#B56959AA;">&#39;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">JSON</span><span style="color:#999999;">.</span><span style="color:#59873A;">stringify</span><span style="color:#999999;">(</span><span style="color:#B07D48;">err</span><span style="color:#999999;">));</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B07D48;">console</span><span style="color:#999999;">.</span><span style="color:#59873A;">log</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">\u652F\u4ED8\u5931\u8D25</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#59873A;">showErrorMsgModal</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#998418;">content</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">err</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">});</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"></span></code></pre></div><h2 id="app-\u652F\u4ED8\u65F6\u7684\u4E8C\u6B21\u7B7E\u540D" tabindex="-1">app \u652F\u4ED8\u65F6\u7684\u4E8C\u6B21\u7B7E\u540D <a class="header-anchor" href="#app-\u652F\u4ED8\u65F6\u7684\u4E8C\u6B21\u7B7E\u540D" aria-hidden="true">#</a></h2><div class="language-js"><button class="copy"></button><span class="lang">js</span><pre class="vp-code-dark"><code><span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">partnerid</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">160*****39</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">key</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">53E12F838************5A43C5DC3</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#758575DD;">// \u62A5\u9519\u652F\u4ED8\u573A\u666F\u4E0D\u5408\u6CD5</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">appid</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">wechatOrder</span><span style="color:#666666;">.</span><span style="color:#BD976A;">orderInfo</span><span style="color:#666666;">.</span><span style="color:#BD976A;">appid</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">timeStamp</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">Math</span><span style="color:#666666;">.</span><span style="color:#80A665;">floor</span><span style="color:#666666;">(</span><span style="color:#CB7676;">new</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">Date</span><span style="color:#666666;">().</span><span style="color:#80A665;">getTime</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">/</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1000</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;&#39;</span><span style="color:#666666;">;</span></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">sign</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">\`</span><span style="color:#C98A7D;">appid=</span><span style="color:#666666;">\${</span><span style="color:#C98A7D;">appid</span><span style="color:#666666;">}</span><span style="color:#C98A7D;">&amp;noncestr=</span><span style="color:#666666;">\${</span><span style="color:#C98A7D;">wechatOrder</span><span style="color:#666666;">.</span><span style="color:#C98A7D;">orderInfo</span><span style="color:#666666;">.</span><span style="color:#C98A7D;">nonce_str</span><span style="color:#666666;">}</span><span style="color:#C98A7D;">&amp;package=Sign=WXPay&amp;partnerid=</span><span style="color:#666666;">\${</span><span style="color:#C98A7D;">partnerid</span><span style="color:#666666;">}</span><span style="color:#C98A7D;">&amp;prepayid=</span><span style="color:#666666;">\${</span><span style="color:#C98A7D;">wechatOrder</span><span style="color:#666666;">.</span><span style="color:#C98A7D;">orderInfo</span><span style="color:#666666;">.</span><span style="color:#C98A7D;">prepay_id</span><span style="color:#666666;">}</span><span style="color:#C98A7D;">&amp;timestamp=</span><span style="color:#666666;">\${</span><span style="color:#C98A7D;">timeStamp</span><span style="color:#666666;">}</span><span style="color:#C98A7D;">&amp;key=</span><span style="color:#666666;">\${</span><span style="color:#C98A7D;">key</span><span style="color:#666666;">}</span><span style="color:#C98A7DAA;">\`</span><span style="color:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">const</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">orderInfo</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">appid</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">appid</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">// \u5FAE\u4FE1\u5F00\u653E\u5E73\u53F0 - \u5E94\u7528 - AppId\uFF0C\u6CE8\u610F\u548C\u5FAE\u4FE1\u5C0F\u7A0B\u5E8F\u3001\u516C\u4F17\u53F7 AppId \u53EF\u80FD\u4E0D\u4E00\u81F4</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">noncestr</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">wechatOrder</span><span style="color:#666666;">.</span><span style="color:#BD976A;">orderInfo</span><span style="color:#666666;">.</span><span style="color:#BD976A;">nonce_str</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">// \u968F\u673A\u5B57\u7B26\u4E32</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">package</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">Sign=WXPay</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">// \u56FA\u5B9A\u503C</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">partnerid</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">partnerid</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">// \u5FAE\u4FE1\u652F\u4ED8\u5546\u6237\u53F7</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">prepayid</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">wechatOrder</span><span style="color:#666666;">.</span><span style="color:#BD976A;">orderInfo</span><span style="color:#666666;">.</span><span style="color:#BD976A;">prepay_id</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">// \u7EDF\u4E00\u4E0B\u5355\u8BA2\u5355\u53F7</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">timestamp</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">timeStamp</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">// \u65F6\u95F4\u6233\uFF08\u5355\u4F4D\uFF1A\u79D2\uFF09</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">sign</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">crypto</span><span style="color:#666666;">.</span><span style="color:#BD976A;">enc</span><span style="color:#666666;">.</span><span style="color:#BD976A;">Hex</span><span style="color:#666666;">.</span><span style="color:#80A665;">stringify</span><span style="color:#666666;">(</span><span style="color:#BD976A;">crypto</span><span style="color:#666666;">.</span><span style="color:#80A665;">HmacSHA256</span><span style="color:#666666;">(</span><span style="color:#BD976A;">sign</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">key</span><span style="color:#666666;">)),</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">// \u7B7E\u540D\uFF0C\u8FD9\u91CC\u7528\u7684 MD5/RSA \u7B7E\u540D</span></span>
<span class="line"><span style="color:#666666;">};</span></span>
<span class="line"><span style="color:#BD976A;">uni</span><span style="color:#666666;">.</span><span style="color:#80A665;">requestPayment</span><span style="color:#666666;">({</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">provider</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">wxpay</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#B8A965;">orderInfo</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">orderInfo</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#80A665;">success</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">res</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#BD976A;">console</span><span style="color:#666666;">.</span><span style="color:#80A665;">log</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">\u8C03\u7528\u5FAE\u4FE1\u652F\u4ED8</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">res</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#80A665;">fail</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#BD976A;">err</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=&gt;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#BD976A;">console</span><span style="color:#666666;">.</span><span style="color:#80A665;">log</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">\u8C03\u7528\u652F\u4ED8\u5931\u8D25</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">err</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#80A665;">complete</span><span style="color:#666666;">(</span><span style="color:#BD976A;">complete</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#BD976A;">console</span><span style="color:#666666;">.</span><span style="color:#80A665;">log</span><span style="color:#666666;">(</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#C98A7D;">complete</span><span style="color:#C98A7DAA;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">complete</span><span style="color:#666666;">);</span></span>
<span class="line"><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">},</span></span>
<span class="line"><span style="color:#666666;">});</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">partnerid</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">160*****39</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">key</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">53E12F838************5A43C5DC3</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#A0ADA0;">// \u62A5\u9519\u652F\u4ED8\u573A\u666F\u4E0D\u5408\u6CD5</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">appid</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">wechatOrder</span><span style="color:#999999;">.</span><span style="color:#B07D48;">orderInfo</span><span style="color:#999999;">.</span><span style="color:#B07D48;">appid</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">timeStamp</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">Math</span><span style="color:#999999;">.</span><span style="color:#59873A;">floor</span><span style="color:#999999;">(</span><span style="color:#AB5959;">new</span><span style="color:#393A34;"> </span><span style="color:#59873A;">Date</span><span style="color:#999999;">().</span><span style="color:#59873A;">getTime</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">/</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1000</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;&#39;</span><span style="color:#999999;">;</span></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">sign</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">\`</span><span style="color:#B56959;">appid=</span><span style="color:#999999;">\${</span><span style="color:#B56959;">appid</span><span style="color:#999999;">}</span><span style="color:#B56959;">&amp;noncestr=</span><span style="color:#999999;">\${</span><span style="color:#B56959;">wechatOrder</span><span style="color:#999999;">.</span><span style="color:#B56959;">orderInfo</span><span style="color:#999999;">.</span><span style="color:#B56959;">nonce_str</span><span style="color:#999999;">}</span><span style="color:#B56959;">&amp;package=Sign=WXPay&amp;partnerid=</span><span style="color:#999999;">\${</span><span style="color:#B56959;">partnerid</span><span style="color:#999999;">}</span><span style="color:#B56959;">&amp;prepayid=</span><span style="color:#999999;">\${</span><span style="color:#B56959;">wechatOrder</span><span style="color:#999999;">.</span><span style="color:#B56959;">orderInfo</span><span style="color:#999999;">.</span><span style="color:#B56959;">prepay_id</span><span style="color:#999999;">}</span><span style="color:#B56959;">&amp;timestamp=</span><span style="color:#999999;">\${</span><span style="color:#B56959;">timeStamp</span><span style="color:#999999;">}</span><span style="color:#B56959;">&amp;key=</span><span style="color:#999999;">\${</span><span style="color:#B56959;">key</span><span style="color:#999999;">}</span><span style="color:#B56959AA;">\`</span><span style="color:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">const</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">orderInfo</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">appid</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">appid</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">// \u5FAE\u4FE1\u5F00\u653E\u5E73\u53F0 - \u5E94\u7528 - AppId\uFF0C\u6CE8\u610F\u548C\u5FAE\u4FE1\u5C0F\u7A0B\u5E8F\u3001\u516C\u4F17\u53F7 AppId \u53EF\u80FD\u4E0D\u4E00\u81F4</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">noncestr</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">wechatOrder</span><span style="color:#999999;">.</span><span style="color:#B07D48;">orderInfo</span><span style="color:#999999;">.</span><span style="color:#B07D48;">nonce_str</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">// \u968F\u673A\u5B57\u7B26\u4E32</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">package</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">Sign=WXPay</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">// \u56FA\u5B9A\u503C</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">partnerid</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">partnerid</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">// \u5FAE\u4FE1\u652F\u4ED8\u5546\u6237\u53F7</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">prepayid</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">wechatOrder</span><span style="color:#999999;">.</span><span style="color:#B07D48;">orderInfo</span><span style="color:#999999;">.</span><span style="color:#B07D48;">prepay_id</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">// \u7EDF\u4E00\u4E0B\u5355\u8BA2\u5355\u53F7</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">timestamp</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">timeStamp</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">// \u65F6\u95F4\u6233\uFF08\u5355\u4F4D\uFF1A\u79D2\uFF09</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">sign</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">crypto</span><span style="color:#999999;">.</span><span style="color:#B07D48;">enc</span><span style="color:#999999;">.</span><span style="color:#B07D48;">Hex</span><span style="color:#999999;">.</span><span style="color:#59873A;">stringify</span><span style="color:#999999;">(</span><span style="color:#B07D48;">crypto</span><span style="color:#999999;">.</span><span style="color:#59873A;">HmacSHA256</span><span style="color:#999999;">(</span><span style="color:#B07D48;">sign</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">key</span><span style="color:#999999;">)),</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">// \u7B7E\u540D\uFF0C\u8FD9\u91CC\u7528\u7684 MD5/RSA \u7B7E\u540D</span></span>
<span class="line"><span style="color:#999999;">};</span></span>
<span class="line"><span style="color:#B07D48;">uni</span><span style="color:#999999;">.</span><span style="color:#59873A;">requestPayment</span><span style="color:#999999;">({</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">provider</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">wxpay</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#998418;">orderInfo</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">orderInfo</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#59873A;">success</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">res</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B07D48;">console</span><span style="color:#999999;">.</span><span style="color:#59873A;">log</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">\u8C03\u7528\u5FAE\u4FE1\u652F\u4ED8</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">res</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#59873A;">fail</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B07D48;">err</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B07D48;">console</span><span style="color:#999999;">.</span><span style="color:#59873A;">log</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">\u8C03\u7528\u652F\u4ED8\u5931\u8D25</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">err</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#59873A;">complete</span><span style="color:#999999;">(</span><span style="color:#B07D48;">complete</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B07D48;">console</span><span style="color:#999999;">.</span><span style="color:#59873A;">log</span><span style="color:#999999;">(</span><span style="color:#B56959AA;">&#39;</span><span style="color:#B56959;">complete</span><span style="color:#B56959AA;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">complete</span><span style="color:#999999;">);</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#999999;">},</span></span>
<span class="line"><span style="color:#999999;">});</span></span>
<span class="line"></span></code></pre></div>`,8),e=[o];function c(r,t,y,A,D,B){return n(),a("div",null,e)}const C=s(l,[["render",c]]);export{E as __pageData,C as default};
